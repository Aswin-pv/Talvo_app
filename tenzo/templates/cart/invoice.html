{% extends 'base.html' %}
{% load static %}
{% load custom_filters %}

{% block link %}
{% endblock %}

{% block content %}
{% include 'component/topheader.html' %}
{% include 'component/header.html' %}

<section class="card pt-5" id="invoice-section">
    <div class="card-body">
      <div class="container mb-5 mt-3">
        <div class="row d-flex align-items-baseline">
          <div class="col-xl-9">
            <p style="color: #7e8d9f;font-size: 20px;">Booking >> <strong>ID: {{ bookings.order_id }}</strong></p>
          </div>
          <div class="col-xl-3 float-end">
            <a class="btn btn-light text-capitalize border-0 mb-3" id="print-btn" data-mdb-ripple-color="dark" onclick=printInvoice()><i
                class="fas fa-print text-primary"></i> Print</a>
          </div>
          <hr>
        </div>
  
        <div class="container">
          <div class="col-md-12">
            <div class="text-center py-2">
              <li class="d-flex justify-content-center align-items-center"><img src="{% static 'images/logo/TalvoLogo.png' %}" alt="" height="50px" width="170px" class="main-logo" /></li>
         
            </div>
  
          </div>
  
  
          <div class="row">
            <div class="col-xl-8">
              <ul class="list-unstyled">
                <li class="text-muted">To: <span style="color:#5d9fc5 ;"></span></li>
                <li class="text-muted">{{ bookings.address1 }}</li>
                <li class="text-muted">{{ bookings.address2 }}</li>
                <li class="text-muted">{{ bookings.city }}</li>
                <li class="text-muted">{{ bookings.state }}</li>
                <li class="text-muted">{{ bookings.pincode }}</li>
                <li class="text-muted"><i class="fas fa-phone"></i> {{ bookings.phone }}</li>
              </ul>
            </div>
            <div class="col-xl-4">
              <p class="text-muted">Invoice</p>
              <ul class="list-unstyled">
                <li class="text-muted"><i class="fas fa-circle" style="color:#84B0CA ;"></i> <span
                    class="fw-bold">Payment mode: {{ bookings.payment_mode }}</span></li>
                    {% if bookings.payment_mode == 'razorpay' %}
                <li class="text-muted"><i class="fas fa-circle" style="color:#84B0CA ;"></i> <span
                    class="fw-bold">Payment ID: <span>{{bookings.razorpay_payment_id}}</span></li>
                    {% endif %}
                <li class="text-muted"><i class="fas fa-circle" style="color:#84B0CA ;"></i> <span
                    class="fw-bold">Booked Date: </span>{{ bookings.booking_date }}</li>
                    {% if bookings.billing_status %}
                <li class="text-muted"><i class="fas fa-circle" style="color:#84B0CA ;"></i> <span
                    class="me-1 fw-bold">Status:</span><span class="badge bg-warning text-black fw-bold">
                    Paid</span></li>
                    {% else %}
                    <li class="text-muted"><i class="fas fa-circle" style="color:#84B0CA ;"></i> <span
                      class="me-1 fw-bold">Status:</span><span class="badge bg-warning text-black fw-bold">
                      Unpaid</span></li>
                      {% endif %}
                      <li class="text-muted"><i class="fas fa-circle" style="color:#84B0CA ;"></i> <span
                        class="fw-bold">Created at: </span>{{ bookings.created }}</li>     
              </ul>
            </div>
          </div>
          
          <div class="row my-2 mx-1 justify-content-center">
            <table class="table table-striped table-borderless">
              <thead style="background-color:#84B0CA ;" class="text-white">
                <tr>
                  <th scope="col">#</th>
                  <th scope="col">Subcategory</th>
                 
                  <th scope="col">Qty</th>
                  <th scope="col">Unit Price</th>
                  <th scope="col">Amount</th>
                </tr>
              </thead>
              {% for subcategory in booking_subcategory %}
              <tbody>
                
                <tr>
                  <th scope="row">1</th>
                  <td>{{ subcategory.subcategory }}</td>
                  <td>{{ subcategory.quantity }}</td>
                  <td>{{ subcategory.price }}</td>
                  <td>₹{{ subcategory.price|quantity_filter:subcategory.quantity }}</td>
    
                </tr>
              
              </tbody>
              {% endfor %}
  
            </table>
          </div>
          <div class="row">
            <div class="col-xl-8">
              <p class="ms-3">Add additional notes and payment information</p>
  
            </div>
            <div class="col-xl-3">
              <ul class="list-unstyled">
                <li class="text-muted ms-3"><span class="text-black me-4">SubTotal</span>₹{{ bookings.total_price }}</li>
                <li class="text-muted ms-3 mt-2"><span class="text-black me-4">GST</span>₹{{ bookings.tax }}</li>
                <li class="text-muted ms-3 mt-2"><span class="text-black me-4">Discount</span>₹{{ bookings.coupon_discount }}</li>
              </ul>
              <p class="text-black float-start"><span class="text-black me-3"> Total Amount</span><span
                  style="font-size: 25px;">₹{{ bookings.grand_total }}</span></p>
            </div>
          </div>
          <hr>
          <div class="row">
            <div class="col-xl-10">
              <p>Thank you for your purchase</p>
            </div>
          </div>
  
        </div>
      </div>
    </div>
</section>


{% endblock %}

{% block scripts %}

<script>

function printInvoice() {
  
  var printContents = document.getElementById("invoice-section").innerHTML;
  var originalContents = document.body.innerHTML;

  // Create a new element to hold the cloned content
  var tempContainer = document.createElement("div");
  tempContainer.innerHTML = printContents;

  // Append the cloned content to the body
  document.body.innerHTML = "";
  document.body.appendChild(tempContainer);

  // Hide the print button before printing
  document.getElementById("print-btn").style.display = "none";

  // Perform the print action
  window.print();

  // Restore the original content and show the print button
  document.body.innerHTML = originalContents;
  document.getElementById("print-btn").style.display = "block";
}

</script>


{% endblock%}
